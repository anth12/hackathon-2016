App.service("UserDataService",function(e){var r={currentUser:null,getCurrentUser:function(){var s=Q.defer(),t=localStorage.getItem("SessionId");return null==t?e.post("/api/user/create").then(function(e){if(r.currentUser=e.data,r.currentUser.Sessions.length<0)throw Error("Invalid session");var t=r.currentUser.Sessions[r.currentUser.Sessions.length-1];localStorage.setItem("SessionId",t.ClientId),s.resolve(r.currentUser)}):e.get("/api/user/"+t).then(function(e){r.currentUser=e.data,s.resolve(r.currentUser)}),s.promise}};return r});