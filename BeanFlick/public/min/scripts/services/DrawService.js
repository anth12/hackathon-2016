App.service("DrawService",function(e,t,a,r,o,i){function n(){h(),w.drawImage(m.image,0,0,m.width,m.height),o.mouthArea.y>=s-100&&p?s+=1:(p=!1,s-=1,o.mouthArea.y>=s&&(p=!0)),w.beginPath(),w.rect(o.mouthArea.x,o.mouthArea.y,u,s),w.fillStyle="black",w.fill(),w.putImageData(v,g,s),w.drawImage(f.image,a.x-f.centerX,a.y-f.centerY,f.width,f.height),c=window.requestAnimationFrame(function(){n()})}function h(){t.canvasContext.clearRect(0,0,t.width,t.height)}var c,l,f,m,s,g,u,d,w,v,p=!0;this.draw=function(){f=r.throwable,m=r.face,w=t.canvasContext,s=o.mouthArea.y,g=o.mouthArea.x,u=o.mouthArea.width,d=o.mouthArea.height,w.beginPath(),w.rect(o.mouthArea.x,o.mouthArea.y,u,s),w.fillStyle="black",w.fill(),w.drawImage(m.image,0,0,m.width,m.height),v=w.getImageData(g,s,u,d),s+=1,w.putImageData(v,g,s),w.drawImage(f.image,a.x-f.centerX,a.y-f.centerY,f.width,f.height),n()},this.clear=function(){h()},this.movement=function(){var n=e.defer();o.powerSetting;return l=setInterval(function(){var e=i.scored();e&&(clearInterval(l),n.resolve({stop:!0,scored:!0}));var o=i.friction();o&&(clearInterval(l),n.resolve({stop:!0,scored:!1})),a.y-r.throwable.centerY+t.offsetTop>0&&a.y+r.throwable.centerY+t.offsetTop<t.offsetTop+t.height?a.y-=a.movementData.speedY/300:(clearInterval(l),n.resolve({stop:!0,scored:!1})),a.x-r.throwable.centerX+t.offsetLeft>0&&a.x+r.throwable.centerX+t.offsetLeft<t.offsetLeft+t.width?a.x+=a.movementData.speedX/300:(clearInterval(l),n.resolve({stop:!0,scored:!1}))}),n.promise}});