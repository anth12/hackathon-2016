App.service("DrawService",["$q","CanvasFactory","InteractionFactory","ImageFactory","GlobalSettingsFactory","CalculatorService",function(e,t,r,o,a,n){function c(e){i();var o=a.mouthArea,n=t.canvasContext;n.beginPath(),n.rect(o.x,o.y,o.width,o.height),n.fillStyle="red",n.fill(),n.drawImage(e.image,r.x-e.centerX,r.y-e.centerY,e.width,e.height),s=window.requestAnimationFrame(function(){c(e)})}function i(){t.canvasContext.clearRect(0,0,t.width,t.height)}var s,l;this.draw=function(e){c(e)},this.clear=function(){i()},this.movement=function(){var c=e.defer();a.powerSetting;return l=setInterval(function(){var e=n.scored();e&&(clearInterval(l),c.resolve({stop:!0,scored:!0}));var a=n.friction();a&&(clearInterval(l),c.resolve({stop:!0,scored:!1})),r.y-o.throwable.centerY+t.offsetTop>0&&r.y+o.throwable.centerY+t.offsetTop<t.offsetTop+t.height?r.y-=r.movementData.speedY/300:(clearInterval(l),c.resolve({stop:!0,scored:!1})),r.x-o.throwable.centerX+t.offsetLeft>0&&r.x+o.throwable.centerX+t.offsetLeft<t.offsetLeft+t.width?r.x+=r.movementData.speedX/300:(clearInterval(l),c.resolve({stop:!0,scored:!1}))}),c.promise}}]);