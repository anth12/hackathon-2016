App.service("DrawService",function(t,e,h,o,a,i){function m(){f(),n(),r(),v.drawImage(d.image,o.face.shiftX,d.positionY,d.width/2,d.height/2),l(),v.drawImage(D,o.face.shiftX,w),u(),v.drawImage(g.image,h.x-g.centerX,h.y-g.centerY,g.width,g.height),window.requestAnimationFrame(function(){m()})}function n(){v.beginPath(),v.rect(0,0,e.width,e.height),v.fillStyle="#17c2a4",v.fill()}function u(){v.beginPath(),v.rect(0,e.height-a.throwAreaHeight,e.width,a.throwAreaHeight),v.fillStyle="#d74680",v.fill()}function r(){0>=w-50&&a.mouthClosed?w+=a.mouthSpeed:(a.mouthClosed=!1,w-=a.mouthSpeed,0>=w&&(a.mouthClosed=!0)),h.mouthOpening=w}function c(){y.clearRect(0,0,v.width,v.height),y.beginPath(),y.moveTo(a.mouthData.mouthLeft.x,a.mouthData.mouthLeft.y),y.lineTo(a.mouthData.mouthRight.x,a.mouthData.mouthRight.y),y.lineTo(a.mouthData.mouthRight.x,a.mouthData.mouthRight.y+50),y.lineTo(a.mouthData.mouthLeft.x,a.mouthData.mouthLeft.y+50-(a.mouthData.mouthLeft.y-a.mouthData.mouthRight.y)),y.closePath(),y.clip(),y.drawImage(d.image,0,d.positionY,d.width/2,d.height/2)}function l(){v.beginPath(),v.fillStyle="black",v.moveTo(a.mouthData.mouthLeft.x+o.face.shiftX,a.mouthData.mouthLeft.y),v.lineTo(a.mouthData.mouthRight.x+o.face.shiftX,a.mouthData.mouthRight.y),v.lineTo(a.mouthData.mouthRight.x+o.face.shiftX,a.mouthData.mouthRight.y+50),v.lineTo(a.mouthData.mouthLeft.x+o.face.shiftX,a.mouthData.mouthLeft.y+50-(a.mouthData.mouthLeft.y-a.mouthData.mouthRight.y)),v.closePath(),v.fill()}function f(){e.canvasContext.clearRect(0,0,e.width,e.height)}var s,g,d,w,v,D,y;this.draw=function(){g=o.throwable,d=o.face,o.face.shiftX=(e.width-d.width/2)/2,v=e.canvasContext,D=document.createElement("canvas"),D.width=d.width/2,D.height=d.height/2,y=D.getContext("2d"),w=0,n(),c(),m()},this.movement=function(){var m=t.defer();a.powerSetting;return s=setInterval(function(){var t=i.scored();t&&(clearInterval(s),m.resolve({stop:!0,scored:!0}));var a=i.friction();a&&(clearInterval(s),m.resolve({stop:!0,scored:!1})),h.y-o.throwable.centerY>0&&h.y+o.throwable.centerY<e.height?h.y-=h.movementData.speedY/300:(clearInterval(s),m.resolve({stop:!0,scored:!1})),h.x-o.throwable.centerX>0&&h.x+o.throwable.centerX<e.width?h.x+=h.movementData.speedX/300:(clearInterval(s),m.resolve({stop:!0,scored:!1}))}),m.promise}});