App.service("DrawService",function(e,t,a,r,o,h){function i(){l(),p.drawImage(u.image,g,0,u.width,u.height),p.beginPath(),p.rect(0,t.height-o.throwAreaHeight,t.width,o.throwAreaHeight),p.fillStyle="#d74680",p.fill(),n(),p.drawImage(d.image,a.x-d.centerX,a.y-d.centerY,d.width,d.height),c=window.requestAnimationFrame(function(){i()})}function n(){o.mouthArea.y>=s-100&&o.mouthClosed?s+=o.mouthSpeed:(o.mouthClosed=!1,s-=o.mouthSpeed,o.mouthArea.y>=s&&(o.mouthClosed=!0)),a.mouthOpening=s,p.beginPath(),p.rect(o.mouthArea.x,o.mouthArea.y,v,s),p.fillStyle="black",p.fill(),p.putImageData(A,w,s)}function l(){t.canvasContext.clearRect(0,0,t.width,t.height)}var c,m,d,u,g,s,w,v,f,p,A;this.draw=function(){d=r.throwable,u=r.face,g=(t.width-u.width)/2,p=t.canvasContext,s=o.mouthArea.y,w=o.mouthArea.x,v=o.mouthArea.width,f=o.mouthArea.height,p.beginPath(),p.rect(o.mouthArea.x,o.mouthArea.y,v,s),p.fillStyle="black",p.fill(),p.drawImage(u.image,g,0,u.width,u.height),A=p.getImageData(w,s,v,f),s+=1,p.putImageData(A,w,s),p.drawImage(d.image,a.x-d.centerX,a.y-d.centerY,d.width,d.height),i()},this.movement=function(){var i=e.defer();o.powerSetting;return m=setInterval(function(){var e=h.scored();e&&(clearInterval(m),i.resolve({stop:!0,scored:!0}));var o=h.friction();o&&(clearInterval(m),i.resolve({stop:!0,scored:!1})),a.y-r.throwable.centerY>0&&a.y+r.throwable.centerY<t.height?a.y-=a.movementData.speedY/300:(clearInterval(m),i.resolve({stop:!0,scored:!1})),a.x-r.throwable.centerX>0&&a.x+r.throwable.centerX<t.width?a.x+=a.movementData.speedX/300:(clearInterval(m),i.resolve({stop:!0,scored:!1}))}),i.promise}});