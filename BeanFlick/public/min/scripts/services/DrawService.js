App.service("DrawService",["$q","CanvasFactory","InteractionFactory","ImageFactory","GlobalSettingsFactory","CalculatorService",function(e,t,r,a,n,o){function i(e){c();var a=n.mouthArea,o=t.canvasContext;o.beginPath(),o.rect(a.x,a.y,a.width,a.height),o.fillStyle="red",o.fill(),o.drawImage(e.image,r.x-e.centerX,r.y-e.centerY,e.width,e.height),f=window.requestAnimationFrame(function(){i(e)})}function c(){t.canvasContext.clearRect(0,0,t.width,t.height)}var f,l;this.draw=function(e){i(e)},this.clear=function(){c()},this.movement=function(){var i=e.defer();n.powerSetting;return l=setInterval(function(){var e=o.friction();e?(clearInterval(l),i.resolve(!0)):(r.y-a.throwable.centerY+t.offsetTop>0&&r.y+a.throwable.centerY+t.offsetTop<t.offsetTop+t.height?r.y-=r.movementData.speedY/300:(clearInterval(l),i.resolve(!0)),r.x-a.throwable.centerX+t.offsetLeft>0&&r.x+a.throwable.centerX+t.offsetLeft<t.offsetLeft+t.width?r.x+=r.movementData.speedX/300:(clearInterval(l),i.resolve(!0)))}),i.promise}}]);