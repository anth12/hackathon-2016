App.service("DrawService",["$q","CanvasFactory","InteractionFactory","ImageFactory","GlobalSettingsFactory","CalculatorService",function(e,t,r,a,o,n){function c(){i();var e=o.mouthArea,a=t.canvasContext;a.beginPath(),a.rect(e.x,e.y,e.width,e.height),a.fillStyle="red",a.fill(),a.drawImage(h.image,0,0,h.width,h.height),a.drawImage(f.image,r.x-f.centerX,r.y-f.centerY,f.width,f.height),s=window.requestAnimationFrame(function(){c()})}function i(){t.canvasContext.clearRect(0,0,t.width,t.height)}var s,l,f,h;this.draw=function(){f=a.throwable,h=a.face,c()},this.clear=function(){i()},this.movement=function(){var c=e.defer();o.powerSetting;return l=setInterval(function(){var e=n.scored();e&&(clearInterval(l),c.resolve({stop:!0,scored:!0}));var o=n.friction();o&&(clearInterval(l),c.resolve({stop:!0,scored:!1})),r.y-a.throwable.centerY+t.offsetTop>0&&r.y+a.throwable.centerY+t.offsetTop<t.offsetTop+t.height?r.y-=r.movementData.speedY/300:(clearInterval(l),c.resolve({stop:!0,scored:!1})),r.x-a.throwable.centerX+t.offsetLeft>0&&r.x+a.throwable.centerX+t.offsetLeft<t.offsetLeft+t.width?r.x+=r.movementData.speedX/300:(clearInterval(l),c.resolve({stop:!0,scored:!1}))}),c.promise}}]);