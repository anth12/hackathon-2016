App.service("DrawService",function(e,t,a,r,o,n){function i(){h(),v.drawImage(m.image,0,0,m.width,m.height),o.mouthArea.y>=d-100&&p?d+=1:(p=!1,d-=1,o.mouthArea.y>=d&&(p=!0)),v.putImageData(u,w,d),v.drawImage(f.image,a.x-f.centerX,a.y-f.centerY,f.width,f.height),c=window.requestAnimationFrame(function(){i()})}function h(){t.canvasContext.clearRect(0,0,t.width,t.height)}var c,s,f,m,d,w,g,l,v,u,p=!0;this.draw=function(){f=r.throwable,m=r.face,v=t.canvasContext,d=o.mouthArea.y,w=o.mouthArea.x,g=o.mouthArea.width,l=o.mouthArea.height,v.drawImage(m.image,0,0,m.width,m.height),u=v.getImageData(w,d,g,l),d+=1,v.putImageData(u,w,d),v.drawImage(f.image,a.x-f.centerX,a.y-f.centerY,f.width,f.height),i()},this.clear=function(){h()},this.movement=function(){var i=e.defer();o.powerSetting;return s=setInterval(function(){var e=n.scored();e&&(clearInterval(s),i.resolve({stop:!0,scored:!0}));var o=n.friction();o&&(clearInterval(s),i.resolve({stop:!0,scored:!1})),a.y-r.throwable.centerY+t.offsetTop>0&&a.y+r.throwable.centerY+t.offsetTop<t.offsetTop+t.height?a.y-=a.movementData.speedY/300:(clearInterval(s),i.resolve({stop:!0,scored:!1})),a.x-r.throwable.centerX+t.offsetLeft>0&&a.x+r.throwable.centerX+t.offsetLeft<t.offsetLeft+t.width?a.x+=a.movementData.speedX/300:(clearInterval(s),i.resolve({stop:!0,scored:!1}))}),i.promise}});